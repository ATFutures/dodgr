<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Distances on Directed Graphs • dodgr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Distances on Directed Graphs">
<meta property="og:description" content="Distances on dual-weighted directed graphs using
    priority-queue shortest paths (Padgham (2019) &lt;doi:10.32866/6945&gt;).
    Weighted directed graphs have weights from A to B which may differ
    from those from B to A.  Dual-weighted directed graphs have two sets
    of such weights. A canonical example is a street network to be used
    for routing in which routes are calculated by weighting distances
    according to the type of way and mode of transport, yet lengths of
    routes must be calculated from direct distances.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">dodgr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.7.011</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="articles/index.html">Vignettes</a>
</li>
<li>
  <a href="reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ATFutures/dodgr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<p><a href="https://cran.r-project.org/package=dodgr"><img src="http://www.r-pkg.org/badges/version/dodgr" alt="CRAN_Status_Badge"></a> <a href="https://cran.r-project.org/package=dodgr"><img src="http://cranlogs.r-pkg.org/badges/grand-total/dodgr?color=orange" alt="CRAN Downloads"></a> <a href="https://bestpractices.coreinfrastructure.org/projects/1396"><img src="https://bestpractices.coreinfrastructure.org/projects/1396/badge" alt="CII Best Practices"></a></p>
<div id="dodgr-distances-on-directed-graphs-in-r" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#dodgr-distances-on-directed-graphs-in-r" class="anchor"></a>dodgr: Distances on Directed Graphs in R</h1></div>
<p><code>dodgr</code> is an R package for efficient calculation of many-to-many pairwise distances on dual-weighted directed graphs, for aggregation of flows throughout networks, and for highly realistic routing through street networks (time-based routing considering incline, turn-angles, surface quality, everything).</p>
<p>Note that most <code>dodgr</code> algorithms implement parallel computation with the <a href="https://rcppcore.github.io/RcppParallel/"><code>RcppParallel</code> library</a>, and by default use the maximal number of available cores or threads. If you do not wish <code>dodgr</code>to use all available threads, please reduce the number manually by first specifying a value via</p>
<div class="sourceCode" id="cb1"><pre class="r">RcppParallel::setThreadOptions (numThreads = &lt;desired_number&gt;)</pre></div>
<div id="whats-so-special" class="section level2">
<h2 class="hasAnchor">
<a href="#whats-so-special" class="anchor"></a>What’s so special?</h2>
<p>Four aspects. First, while other packages exist for calculating distances on directed graphs, notably <a href="https://igraph.org/r"><code>igraph</code></a>, even that otherwise fabulous package does not (readily) permit analysis of <em>dual-weighted</em> graphs. Dual-weighted graphs have two sets of weights for each edge, so routing can be evaluated with one set of weights, while distances can be calculated with the other. A canonical example is a street network, where <em>weighted distances</em> are assigned depending on mode of transport (for example, weighted distances for pedestrians on multi-lane vehicular roads are longer than equivalent distances along isolated walking paths), yet the desired output remains direct, unweighted distances. Accurate calculation of distances on street networks requires a dual-weighted representation. In <strong>R</strong>, <code>dodgr</code> is currently the only package that offers this functionality (without excessive data wrangling).</p>
<p>Second, while <a href="https://igraph.org/r"><code>igraph</code></a> and almost all other routing packages are primarily designed for one-to-one routing, <code>dodgr</code> is specifically designed for many-to-many routing, and will generally outperform equivalent packages in large routing tasks.</p>
<p>Third, <code>dodgr</code> goes beyond the functionality of comparable packages through including routines to aggregate flows throughout a network, through specifying origins, destinations, and flow densities between each pair of points. Alternatively, flows can be aggregated according to a network dispersal model from a set of origin points and associated densities, and a user-specified dispersal model.</p>
<p>Fourth and finally, <code>dodgr</code> implements highly realistic and fully-customisable profiles for routing through street networks with various modes of transport, and using either distance- or time-based routing. Routing can include such factors as waiting times at traffic lights, delays for turning across oncoming traffic, and the effects of elevation on both cyclists and pedestrians.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install latest stable version of <code>dodgr</code> from CRAN with:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"dodgr"</span>) <span class="co"># current CRAN version</span></pre></div>
<p>Alternatively, current development versions can be installed using any of the following options:</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="co"># install.packages("remotes")</span>
<span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_git.html">install_git</a></span>(<span class="st">"https://git.sr.ht/~mpadge/dodgr"</span>)
<span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_bitbucket.html">install_bitbucket</a></span>(<span class="st">"atfutures/dodgr"</span>)
<span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_gitlab.html">install_gitlab</a></span>(<span class="st">"atfutures1/dodgr"</span>)
<span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"ATFutures/dodgr"</span>)</pre></div>
<p>Then load with</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span> (<span class="no">dodgr</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span> (<span class="st">"dodgr"</span>)
<span class="co">#&gt; [1] '0.2.7'</span></pre></div>
</div>
<div id="usage-sample-data-and-dodgr-networks" class="section level2">
<h2 class="hasAnchor">
<a href="#usage-sample-data-and-dodgr-networks" class="anchor"></a>Usage: Sample Data and <code>dodgr</code> networks</h2>
<p>To illustrate functionality, the package includes an example data set containing the Open Street Map network for <a href="https://www.openstreetmap.org/#map=15/15.3368/76.4601">Hampi, India</a> (a primarily pedestrian village in the middle of a large World Heritage zone). These data are in <a href="https://cran.r-project.org/package=sf">Simple Features (<code>sf</code>)</a> format, as a collection of <code>LINESTRING</code> objects. <code>dodgr</code> represents networks as a simple rectangular graph, with each row representing an edge segment between two points or vertices. <code>sf</code>-format objects can be converted to equivalent <code>dodgr</code> representations with the <code><a href="reference/weight_streetnet.html">weight_streetnet()</a></code> function:</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span> (<span class="no">hampi</span>)
<span class="co">#&gt; [1] "sf"         "data.frame"</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span> (<span class="no">hampi</span>)
<span class="co">#&gt; [1] 203  15</span>
<span class="no">graph</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/weight_streetnet.html">weight_streetnet</a></span> (<span class="no">hampi</span>, <span class="kw">wt_profile</span> <span class="kw">=</span> <span class="st">"foot"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span> (<span class="no">graph</span>)
<span class="co">#&gt; [1] "data.frame"      "dodgr_streetnet"</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span> (<span class="no">graph</span>)
<span class="co">#&gt; [1] 5973   15</span></pre></div>
<p>The <code>sf</code>-format network contained 203 <code>LINESTRING</code> objects, with the <code><a href="reference/weight_streetnet.html">weight_streetnet()</a></code> function decomposing these into 5,973 distinct edges, indicating that the <code>sf</code> representation had around 29 edges or segments in each <code>LINESTRING</code> object. The <code>dodgr</code> network then looks like this:</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span> (<span class="no">graph</span>)</pre></div>
<table class="table">
<colgroup>
<col width="6%">
<col width="5%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="5%">
<col width="5%">
<col width="6%">
<col width="7%">
<col width="8%">
<col width="5%">
<col width="6%">
<col width="6%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="right">geom_num</th>
<th align="right">edge_id</th>
<th align="left">from_id</th>
<th align="right">from_lon</th>
<th align="right">from_lat</th>
<th align="left">to_id</th>
<th align="right">to_lon</th>
<th align="right">to_lat</th>
<th align="right">d</th>
<th align="right">d_weighted</th>
<th align="left">highway</th>
<th align="left">way_id</th>
<th align="right">component</th>
<th align="right">time</th>
<th align="right">time_weighted</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="left">339318500</td>
<td align="right">76.47489</td>
<td align="right">15.34169</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="right">132.442169</td>
<td align="right">165.55271</td>
<td align="left">unclassified</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">95.358362</td>
<td align="right">119.197952</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="left">339318500</td>
<td align="right">76.47489</td>
<td align="right">15.34169</td>
<td align="right">132.442169</td>
<td align="right">165.55271</td>
<td align="left">unclassified</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">95.358362</td>
<td align="right">119.197952</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="right">8.888670</td>
<td align="right">11.11084</td>
<td align="left">unclassified</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">6.399843</td>
<td align="right">7.999803</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="right">8.888670</td>
<td align="right">11.11084</td>
<td align="left">unclassified</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">6.399843</td>
<td align="right">7.999803</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="left">1427116077</td>
<td align="right">76.47628</td>
<td align="right">15.34179</td>
<td align="right">9.326536</td>
<td align="right">11.65817</td>
<td align="left">unclassified</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">6.715106</td>
<td align="right">8.393882</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">6</td>
<td align="left">1427116077</td>
<td align="right">76.47628</td>
<td align="right">15.34179</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="right">9.326536</td>
<td align="right">11.65817</td>
<td align="left">unclassified</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">6.715106</td>
<td align="right">8.393882</td>
</tr>
</tbody>
</table>
<p>The <code>geom_num</code> column maps directly onto the sequence of <code>LINESTRING</code> objects within the <code>sf</code>-formatted data. The <code>highway</code> column is taken directly from Open Street Map, and denotes the kind of “highway” represented by each edge. The <code>component</code> column is an integer value describing which of the connected components of the network each edge belongs to (with <code>1</code> always being the largest component; <code>2</code> the second largest; and so on).</p>
<p>Note that the <code>d_weighted</code> values are often greater than the geometric distances, <code>d</code>. In the example shown, <code>service</code> highways are not ideal for pedestrians, and so weighted distances are slightly greater than actual distances. Compare this with:</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span> (<span class="no">graph</span> [<span class="no">graph</span>$<span class="no">highway</span> <span class="kw">==</span> <span class="st">"path"</span>, ])</pre></div>
<table class="table">
<colgroup>
<col width="1%">
<col width="6%">
<col width="5%">
<col width="7%">
<col width="6%">
<col width="6%">
<col width="7%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="7%">
<col width="5%">
<col width="5%">
<col width="6%">
<col width="5%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th></th>
<th align="right">geom_num</th>
<th align="right">edge_id</th>
<th align="left">from_id</th>
<th align="right">from_lon</th>
<th align="right">from_lat</th>
<th align="left">to_id</th>
<th align="right">to_lon</th>
<th align="right">to_lat</th>
<th align="right">d</th>
<th align="right">d_weighted</th>
<th align="left">highway</th>
<th align="left">way_id</th>
<th align="right">component</th>
<th align="right">time</th>
<th align="right">time_weighted</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>47</td>
<td align="right">2</td>
<td align="right">47</td>
<td align="left">338905220</td>
<td align="right">76.47398</td>
<td align="right">15.31224</td>
<td align="left">338907543</td>
<td align="right">76.47405</td>
<td align="right">15.31241</td>
<td align="right">19.70399</td>
<td align="right">19.70399</td>
<td align="left">path</td>
<td align="left">30643853</td>
<td align="right">1</td>
<td align="right">35.46718</td>
<td align="right">35.46718</td>
</tr>
<tr class="even">
<td>48</td>
<td align="right">2</td>
<td align="right">48</td>
<td align="left">338907543</td>
<td align="right">76.47405</td>
<td align="right">15.31241</td>
<td align="left">338905220</td>
<td align="right">76.47398</td>
<td align="right">15.31224</td>
<td align="right">19.70399</td>
<td align="right">19.70399</td>
<td align="left">path</td>
<td align="left">30643853</td>
<td align="right">1</td>
<td align="right">35.46718</td>
<td align="right">35.46718</td>
</tr>
<tr class="odd">
<td>49</td>
<td align="right">2</td>
<td align="right">49</td>
<td align="left">338907543</td>
<td align="right">76.47405</td>
<td align="right">15.31241</td>
<td align="left">2398957585</td>
<td align="right">76.47410</td>
<td align="right">15.31259</td>
<td align="right">21.39172</td>
<td align="right">21.39172</td>
<td align="left">path</td>
<td align="left">30643853</td>
<td align="right">1</td>
<td align="right">38.50510</td>
<td align="right">38.50510</td>
</tr>
<tr class="even">
<td>50</td>
<td align="right">2</td>
<td align="right">50</td>
<td align="left">2398957585</td>
<td align="right">76.47410</td>
<td align="right">15.31259</td>
<td align="left">338907543</td>
<td align="right">76.47405</td>
<td align="right">15.31241</td>
<td align="right">21.39172</td>
<td align="right">21.39172</td>
<td align="left">path</td>
<td align="left">30643853</td>
<td align="right">1</td>
<td align="right">38.50510</td>
<td align="right">38.50510</td>
</tr>
<tr class="odd">
<td>51</td>
<td align="right">2</td>
<td align="right">51</td>
<td align="left">2398957585</td>
<td align="right">76.47410</td>
<td align="right">15.31259</td>
<td align="left">338907597</td>
<td align="right">76.47413</td>
<td align="right">15.31279</td>
<td align="right">22.15205</td>
<td align="right">22.15205</td>
<td align="left">path</td>
<td align="left">30643853</td>
<td align="right">1</td>
<td align="right">39.87370</td>
<td align="right">39.87370</td>
</tr>
<tr class="even">
<td>52</td>
<td align="right">2</td>
<td align="right">52</td>
<td align="left">338907597</td>
<td align="right">76.47413</td>
<td align="right">15.31279</td>
<td align="left">2398957585</td>
<td align="right">76.47410</td>
<td align="right">15.31259</td>
<td align="right">22.15205</td>
<td align="right">22.15205</td>
<td align="left">path</td>
<td align="left">30643853</td>
<td align="right">1</td>
<td align="right">39.87370</td>
<td align="right">39.87370</td>
</tr>
</tbody>
</table>
<p>A <code>"path"</code> offers ideal walking conditions, and so weighted distances are equal to actual distances.</p>
</div>
<div id="usage-distances-and-times" class="section level2">
<h2 class="hasAnchor">
<a href="#usage-distances-and-times" class="anchor"></a>Usage: Distances and Times</h2>
<p>The many-to-many nature of <code>dodgr</code> means that the function to calculate distances, <a href="https://atfutures.github.io/dodgr/reference/dodgr_distances.html"><code><a href="reference/dodgr_distances.html">dodgr_distances()</a></code></a> or, for street networks, times, <a href="https://atfutures.github.io/dodgr/reference/dodgr_times.html"><code><a href="reference/dodgr_times.html">dodgr_times()</a></code></a>, accepts two vectors or matrices of routing points as inputs (describing origins and destinations), and returns a corresponding matrix of pairwise distances. If an input graph has columns for both distances and weighted distances, and/or times and weighted times, the weighted versions are used to determine the effectively shortest or fastest routes through a network, while actual distances or times are summed along the routes to calculate final values. It is of course also possible to calculate distances along fastest routes, times along shortest routes, or any combination thereof, as detailed in the package vignette on <a href="https://atfutures.github.io/dodgr/articles/times.html">street networks and time-based routing</a>.</p>
<p>Routing points can, for example, be randomly selected from the vertices of a graph. The vertices can in turn be extracted with the <code><a href="reference/dodgr_vertices.html">dodgr_vertices()</a></code> function:</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="no">v</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/dodgr_vertices.html">dodgr_vertices</a></span> (<span class="no">graph</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span> (<span class="no">v</span>)</pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">id</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="right">component</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td align="left">339318500</td>
<td align="right">76.47489</td>
<td align="right">15.34169</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>2</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>4</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>6</td>
<td align="left">1427116077</td>
<td align="right">76.47628</td>
<td align="right">15.34179</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td>8</td>
<td align="left">339318503</td>
<td align="right">76.47641</td>
<td align="right">15.34190</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>10</td>
<td align="left">2398958034</td>
<td align="right">76.47650</td>
<td align="right">15.34199</td>
<td align="right">1</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<p>For OSM data extracted with the <code>osmdata</code> package (or, equivalently, via the <code><a href="reference/dodgr_streetnet.html">dodgr::dodgr_streetnet()</a></code> function), each object (vertices, ways, and high-level relations between these objects) is assigned a unique identifying number. These are retained both in <code>osmdata</code> and <code>dodgr</code>, as the <code>way_id</code> column in the above <code>graph</code>, and as the <code>id</code> column in the vertices. Random vertices may be generated in this case through selecting <code>id</code> values:</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="no">from</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span> (<span class="no">v</span>$<span class="no">id</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>)
<span class="no">to</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span> (<span class="no">v</span>$<span class="no">id</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">50</span>)
<span class="no">d</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/dodgr_dists.html">dodgr_dists</a></span> (<span class="kw">graph</span> <span class="kw">=</span> <span class="no">graph</span>, <span class="kw">from</span> <span class="kw">=</span> <span class="no">from</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="no">to</span>)
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span> (<span class="no">d</span>)
<span class="co">#&gt; [1] 20 50</span></pre></div>
<p>Alternatively, the points may be specified as matrices of geographic coordinates:</p>
<div class="sourceCode" id="cb10"><pre class="r"><span class="no">from_x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span> (<span class="no">graph</span>$<span class="no">from_lon</span>) + <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span> (<span class="fl">20</span>) * <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span> (<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span> (<span class="no">graph</span>$<span class="no">from_lon</span>))
<span class="no">from_y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span> (<span class="no">graph</span>$<span class="no">from_lat</span>) + <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span> (<span class="fl">20</span>) * <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span> (<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span> (<span class="no">graph</span>$<span class="no">from_lat</span>))
<span class="no">to_x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span> (<span class="no">graph</span>$<span class="no">from_lon</span>) + <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span> (<span class="fl">50</span>) * <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span> (<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span> (<span class="no">graph</span>$<span class="no">from_lon</span>))
<span class="no">to_y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span> (<span class="no">graph</span>$<span class="no">from_lat</span>) + <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span> (<span class="fl">50</span>) * <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span> (<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span> (<span class="no">graph</span>$<span class="no">from_lat</span>))
<span class="no">d</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/dodgr_dists.html">dodgr_dists</a></span> (<span class="kw">graph</span> <span class="kw">=</span> <span class="no">graph</span>, <span class="kw">from</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span> (<span class="no">from_x</span>, <span class="no">from_y</span>), <span class="kw">to</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span> (<span class="no">to_x</span>, <span class="no">to_y</span>))</pre></div>
<p>In this case, the random points will be mapped on to the nearest points on the street network. This may, of course, map some points onto minor, disconnected components of the graph. This can be controlled either by reducing the graph to it’s largest connected component only:</p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="no">graph</span> <span class="kw">&lt;-</span> <span class="no">graph</span> [<span class="no">graph</span>$<span class="no">component</span> <span class="kw">==</span> <span class="fl">1</span>, ]
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span> (<span class="no">graph</span>)</pre></div>
<p>or by explicitly using the <code><a href="reference/match_points_to_graph.html">match_points_to_graph()</a></code> function with the option <code>connected = TRUE</code>:</p>
<div class="sourceCode" id="cb12"><pre class="r"><span class="no">from</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/match_points_to_graph.html">match_points_to_graph</a></span> (<span class="no">v</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span> (<span class="no">from_x</span>, <span class="no">from_y</span>), <span class="kw">connected</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">to</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/match_points_to_graph.html">match_points_to_graph</a></span> (<span class="no">v</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span> (<span class="no">to_x</span>, <span class="no">to_y</span>), <span class="kw">connected</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></div>
<p>This function returns an index into the result of <code>dodgr_vertices</code>, and so points to use for routing must then be extracted as follows:</p>
<div class="sourceCode" id="cb13"><pre class="r"><span class="no">from</span> <span class="kw">&lt;-</span> <span class="no">v</span>$<span class="no">id</span> [<span class="no">from</span>] <span class="co"># or from &lt;- v [from, c ("x", "y")]</span>
<span class="no">to</span> <span class="kw">&lt;-</span> <span class="no">v</span>$<span class="no">id</span> [<span class="no">to</span>]
<span class="no">d</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/dodgr_dists.html">dodgr_dists</a></span> (<span class="kw">graph</span> <span class="kw">=</span> <span class="no">graph</span>, <span class="kw">from</span> <span class="kw">=</span> <span class="no">from</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="no">to</span>)</pre></div>
</div>
<div id="usage-flow-aggregation" class="section level2">
<h2 class="hasAnchor">
<a href="#usage-flow-aggregation" class="anchor"></a>Usage: Flow Aggregation</h2>
<p>Flow aggregation refers to the procedure of routing along multiple ways according to specified densities of flow between defined origin and destination points, and aggregating flows along each edge of the network. The procedure is functionally similar to the above procedure for distances, with the addition of a matrix specifying pairwise flow densities between the input set of origin (<code>from</code>) and destination (<code>to</code>) points. The following example illustrates use with a random “flow matrix”:</p>
<div class="sourceCode" id="cb14"><pre class="r"><span class="no">flows</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span> (<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span> (<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span> (<span class="no">from</span>) * <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span> (<span class="no">to</span>)), <span class="kw">dim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span> (<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span> (<span class="no">from</span>), <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span> (<span class="no">to</span>)))
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span> (<span class="no">from</span>); <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span> (<span class="no">to</span>); <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span> (<span class="no">flows</span>)
<span class="co">#&gt; [1] 20</span>
<span class="co">#&gt; [1] 50</span>
<span class="co">#&gt; [1] 20 50</span>
<span class="no">f</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/dodgr_flows_aggregate.html">dodgr_flows_aggregate</a></span> (<span class="kw">graph</span> <span class="kw">=</span> <span class="no">graph</span>, <span class="kw">from</span> <span class="kw">=</span> <span class="no">from</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="no">to</span>, <span class="kw">flows</span> <span class="kw">=</span> <span class="no">flows</span>)</pre></div>
<p>The result is simply the input <code>graph</code> with an additional column quantifying the aggregate flows along each edge:</p>
<div class="sourceCode" id="cb15"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span> (<span class="no">f</span>)</pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="5%">
<col width="6%">
<col width="5%">
<col width="5%">
<col width="6%">
<col width="5%">
<col width="5%">
<col width="6%">
<col width="7%">
<col width="7%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="9%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="right">geom_num</th>
<th align="right">edge_id</th>
<th align="left">from_id</th>
<th align="right">from_lon</th>
<th align="right">from_lat</th>
<th align="left">to_id</th>
<th align="right">to_lon</th>
<th align="right">to_lat</th>
<th align="right">d</th>
<th align="right">d_weighted</th>
<th align="left">highway</th>
<th align="left">way_id</th>
<th align="right">component</th>
<th align="right">time</th>
<th align="right">time_weighted</th>
<th align="right">flow</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="left">339318500</td>
<td align="right">76.47489</td>
<td align="right">15.34169</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="right">132.442169</td>
<td align="right">165.55271</td>
<td align="left">unclassified</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">95.358362</td>
<td align="right">119.197952</td>
<td align="right">0.077674</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="left">339318500</td>
<td align="right">76.47489</td>
<td align="right">15.34169</td>
<td align="right">132.442169</td>
<td align="right">165.55271</td>
<td align="left">unclassified</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">95.358362</td>
<td align="right">119.197952</td>
<td align="right">0.000000</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="right">8.888670</td>
<td align="right">11.11084</td>
<td align="left">unclassified</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">6.399843</td>
<td align="right">7.999803</td>
<td align="right">0.077674</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="right">8.888670</td>
<td align="right">11.11084</td>
<td align="left">unclassified</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">6.399843</td>
<td align="right">7.999803</td>
<td align="right">0.000000</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="left">1427116077</td>
<td align="right">76.47628</td>
<td align="right">15.34179</td>
<td align="right">9.326536</td>
<td align="right">11.65817</td>
<td align="left">unclassified</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">6.715106</td>
<td align="right">8.393882</td>
<td align="right">0.077674</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">6</td>
<td align="left">1427116077</td>
<td align="right">76.47628</td>
<td align="right">15.34179</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="right">9.326536</td>
<td align="right">11.65817</td>
<td align="left">unclassified</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">6.715106</td>
<td align="right">8.393882</td>
<td align="right">0.000000</td>
</tr>
</tbody>
</table>
<p>An additional flow aggregation function can be applied in cases where only densities at origin points are known, and movement throughout a graph is dispersive:</p>
<div class="sourceCode" id="cb16"><pre class="r"><span class="no">f</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/dodgr_flows_disperse.html">dodgr_flows_disperse</a></span> (<span class="kw">graph</span> <span class="kw">=</span> <span class="no">graph</span>, <span class="kw">from</span> <span class="kw">=</span> <span class="no">from</span>, <span class="kw">dens</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span> (<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span> (<span class="no">from</span>)))</pre></div>
</div>
<div id="further-detail" class="section level2">
<h2 class="hasAnchor">
<a href="#further-detail" class="anchor"></a>Further detail</h2>
<p>For more detail, see the <a href="https://atfutures.github.io/dodgr/articles/dodgr.html">main package vignette</a>, and the second vignette on <a href="https://atfutures.github.io/dodgr/articles/times.html">street networks and time-based routing</a> ## Contributors</p>
<!-- ALL-CONTRIBUTORS-LIST:START - Do not remove or modify this section -->
<!-- prettier-ignore-start -->
<!-- markdownlint-disable -->
<p>This project follows the <a href="https://allcontributors.org">all-contributors</a> specification. Contributions of any kind are welcome!</p>
<table class="table"><tr>
<td align="center">
<p><a href="https://github.com/mpadge"> <img src="https://avatars1.githubusercontent.com/u/6697851?v=4" width="100px;" alt=""></a><br><a href="https://github.com/ATFutures/dodgr/commits?author=mpadge">mpadge</a></p>
</td>
<td align="center">
<p><a href="https://github.com/karpfen"> <img src="https://avatars3.githubusercontent.com/u/11758039?v=4" width="100px;" alt=""></a><br><a href="https://github.com/ATFutures/dodgr/commits?author=karpfen">karpfen</a></p>
</td>
<td align="center">
<p><a href="https://github.com/Robinlovelace"> <img src="https://avatars2.githubusercontent.com/u/1825120?v=4" width="100px;" alt=""></a><br><a href="https://github.com/ATFutures/dodgr/commits?author=Robinlovelace">Robinlovelace</a></p>
</td>
<td align="center">
<p><a href="https://github.com/agila5"> <img src="https://avatars1.githubusercontent.com/u/22221146?v=4" width="100px;" alt=""></a><br><a href="https://github.com/ATFutures/dodgr/commits?author=agila5">agila5</a></p>
</td>
<td align="center">
<p><a href="https://github.com/JimShady"> <img src="https://avatars1.githubusercontent.com/u/2901470?v=4" width="100px;" alt=""></a><br><a href="https://github.com/ATFutures/dodgr/commits?author=JimShady">JimShady</a></p>
</td>
<td align="center">
<p><a href="https://github.com/layik"> <img src="https://avatars3.githubusercontent.com/u/408568?v=4" width="100px;" alt=""></a><br><a href="https://github.com/ATFutures/dodgr/commits?author=layik">layik</a></p>
</td>
<td align="center">
<p><a href="https://github.com/virgesmith"> <img src="https://avatars3.githubusercontent.com/u/19323577?v=4" width="100px;" alt=""></a><br><a href="https://github.com/ATFutures/dodgr/commits?author=virgesmith">virgesmith</a></p>
</td>
</tr></table>
<!-- markdownlint-enable --><!-- prettier-ignore-end --><!-- ALL-CONTRIBUTORS-LIST:END -->
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=dodgr">https://​cloud.r-project.org/​package=dodgr</a>
</li>
<li>Browse source code at <br><a href="https://github.com/ATFutures/dodgr/">https://​github.com/​ATFutures/​dodgr/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/ATFutures/dodgr/issues">https://​github.com/​ATFutures/​dodgr/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing dodgr</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Mark Padgham <br><small class="roles"> Author, maintainer </small>  </li>
<li>Andreas Petutschnig <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/atfutures/dodgr/actions?query=workflow%3AR-CMD-check"><img src="https://github.com/atfutures/dodgr/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://travis-ci.org/ATFutures/dodgr"><img src="https://travis-ci.org/ATFutures/dodgr.svg" alt="Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/ATFutures/dodgr"><img src="https://ci.appveyor.com/api/projects/status/github/ATFutures/dodgr?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a></li>
<li><a href="https://codecov.io/gh/ATFutures/dodgr"><img src="https://codecov.io/gh/ATFutures/dodgr/branch/master/graph/badge.svg" alt="codecov"></a></li>
<li><a href="http://www.repostatus.org/#active"><img src="http://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Mark Padgham, Andreas Petutschnig.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
