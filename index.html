<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Distances on Directed Graphs • dodgr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Distances on Directed Graphs">
<meta property="og:description" content="Distances on dual-weighted directed graphs using priority-queue
    shortest paths (Padgham (2019) &lt;doi:10.32866/6945&gt;). Weighted directed
    graphs have weights from A to B which may differ from those from B to A.
    Dual-weighted directed graphs have two sets of such weights. A canonical
    example is a street network to be used for routing in which routes are
    calculated by weighting distances according to the type of way and mode of
    transport, yet lengths of routes must be calculated from direct distances.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">dodgr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="articles/index.html">Vignettes</a>
</li>
<li>
  <a href="reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ATFutures/dodgr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->

<div id="dodgr-distances-on-directed-graphs-in-r" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#dodgr-distances-on-directed-graphs-in-r" class="anchor"></a>dodgr: Distances on Directed Graphs in R</h1></div>
<p>R package for efficient calculation of many-to-many pairwise distances on dual-weighted directed graphs, and for aggregation of flows throughout networks.</p>
<div id="whats-so-special" class="section level2">
<h2 class="hasAnchor">
<a href="#whats-so-special" class="anchor"></a>What’s so special?</h2>
<p>Three aspects. First, while other packages exist for calculating distances on directed graphs, notably <a href="https://igraph.org/r"><code>igraph</code></a>, even this otherwise fabulous package does not (readily) permit analysis of <em>dual-weighted</em> graphs. Dual-weighted graphs have two sets of weights for each edge, so routing can be evaluated with one set of weights, while distances can be calculated with the other. A canonical example is a street network, where <em>weighted distances</em> are assigned depending on mode of transport (for example, weighted distances for pedestrians on multi-lane vehicular roads are longer than equivalent distances along isolated walking paths), yet the desired output remains direct, unweighted distances. Accurate calculation of distances on street networks requires a dual-weighted representation. In <strong>R</strong>, <code>dodgr</code> is currently the only package that offers this functionality (without excessive data wrangling).</p>
<p>Second, while <a href="https://igraph.org/r"><code>igraph</code></a> and almost all other routing packages are primarily designed for one-to-one routing, <code>dodgr</code> is specifically designed for many-to-many routing, and will generally outperform equivalent packages in large routing tasks.</p>
<p>Third, <code>dodgr</code> goes beyond the functionality of comparable packages through including routines to aggregate flows throughout a network, through specifying origins, destinations, and flow densities between each pair of points. Alternatively, flows can be aggregated according to a network dispersal model from a set of origin points and associated densities, and a user-specified dispersal model.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install <code>dodgr</code> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"dodgr"</span>) <span class="co"># current CRAN version</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co"># install.packages("remotes")</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">remotes<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(<span class="st">"ATFutures/dodgr"</span>) <span class="co"># Development version</span></a></code></pre></div>
<p>Then load with</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span> (dodgr)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/packageDescription">packageVersion</a></span> (<span class="st">"dodgr"</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; [1] '0.1.3.3'</span></a></code></pre></div>
</div>
<div id="usage-sample-data-and-dodgr-networks" class="section level2">
<h2 class="hasAnchor">
<a href="#usage-sample-data-and-dodgr-networks" class="anchor"></a>Usage: Sample Data and <code>dodgr</code> networks</h2>
<p>To illustrate functionality, the package includes an example data set containing the Open Street Map network for <a href="https://www.openstreetmap.org/#map=15/15.3368/76.4601">Hampi, India</a> (a primarily pedestrian village in the middle of a large World Heritage zone). These data are in <a href="https://cran.r-project.org/package=sf">Simple Features (<code>sf</code>)</a> format, as a collection of <code>LINESTRING</code> objects. <code>dodgr</code> represents networks as a simple rectangular graph, with each row representing an edge segment between two points or vertices. <code>sf</code>-format objects can be converted to equivalent <code>dodgr</code> representations with the <code><a href="reference/weight_streetnet.html">weight_streetnet()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span> (hampi)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; [1] "sf"         "data.frame"</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span> (hampi)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; [1] 191  15</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">graph &lt;-<span class="st"> </span><span class="kw"><a href="reference/weight_streetnet.html">weight_streetnet</a></span> (hampi, <span class="dt">wt_profile =</span> <span class="st">"foot"</span>)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span> (graph)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; [1] "data.frame"      "dodgr_streetnet"</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span> (graph)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; [1] 5845   15</span></a></code></pre></div>
<p>The <code>sf</code>-format network contained 191 <code>LINESTRING</code> objects, with the <code><a href="reference/weight_streetnet.html">weight_streetnet()</a></code> function decomposing these into 5,845 distinct edges, indicating that the <code>sf</code> representation had around 31 edges or segments in each <code>LINESTRING</code> object. The <code>dodgr</code> network then looks like this:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span> (graph)</a></code></pre></div>
<table class="table table">
<thead><tr class="header">
<th align="right">geom_num</th>
<th align="right">edge_id</th>
<th align="left">from_id</th>
<th align="right">from_lon</th>
<th align="right">from_lat</th>
<th align="left">to_id</th>
<th align="right">to_lon</th>
<th align="right">to_lat</th>
<th align="right">d</th>
<th align="right">d_weighted</th>
<th align="left">highway</th>
<th align="left">way_id</th>
<th align="right">component</th>
<th align="right">time</th>
<th align="right">time_weighted</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="left">339318500</td>
<td align="right">76.47489</td>
<td align="right">15.34169</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="right">0.1324422</td>
<td align="right">0.1471580</td>
<td align="left">service</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">0.0953584</td>
<td align="right">0.1059537</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="left">339318500</td>
<td align="right">76.47489</td>
<td align="right">15.34169</td>
<td align="right">0.1324422</td>
<td align="right">0.1471580</td>
<td align="left">service</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">0.0953584</td>
<td align="right">0.1059537</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="right">0.0088887</td>
<td align="right">0.0098763</td>
<td align="left">service</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">0.0063998</td>
<td align="right">0.0071109</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="right">0.0088887</td>
<td align="right">0.0098763</td>
<td align="left">service</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">0.0063998</td>
<td align="right">0.0071109</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="left">1427116077</td>
<td align="right">76.47628</td>
<td align="right">15.34179</td>
<td align="right">0.0093265</td>
<td align="right">0.0103628</td>
<td align="left">service</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">0.0067151</td>
<td align="right">0.0074612</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">6</td>
<td align="left">1427116077</td>
<td align="right">76.47628</td>
<td align="right">15.34179</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="right">0.0093265</td>
<td align="right">0.0103628</td>
<td align="left">service</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">0.0067151</td>
<td align="right">0.0074612</td>
</tr>
</tbody>
</table>
<p>The <code>geom_num</code> column maps directly onto the sequence of <code>LINESTRING</code> objects within the <code>sf</code>-formatted data. The <code>highway</code> column is taken directly from Open Street Map, and denotes the kind of “highway” represented by each edge. The <code>component</code> column is an integer value describing which of the connected components of the network each edge belongs to (with <code>1</code> always being the largest component; <code>2</code> the second largest; and so on).</p>
<p>Note that the <code>d_weighted</code> values are often greater than the geometric distances, <code>d</code>. In the example shown, <code>service</code> highways are not ideal for pedestrians, and so weighted distances are slightly greater than actual distances. Compare this with:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span> (graph [graph<span class="op">$</span>highway <span class="op">==</span><span class="st"> "path"</span>, ])</a></code></pre></div>
<table class="table table">
<thead><tr class="header">
<th></th>
<th align="right">geom_num</th>
<th align="right">edge_id</th>
<th align="left">from_id</th>
<th align="right">from_lon</th>
<th align="right">from_lat</th>
<th align="left">to_id</th>
<th align="right">to_lon</th>
<th align="right">to_lat</th>
<th align="right">d</th>
<th align="right">d_weighted</th>
<th align="left">highway</th>
<th align="left">way_id</th>
<th align="right">component</th>
<th align="right">time</th>
<th align="right">time_weighted</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>47</td>
<td align="right">2</td>
<td align="right">47</td>
<td align="left">338905220</td>
<td align="right">76.47398</td>
<td align="right">15.31224</td>
<td align="left">338907543</td>
<td align="right">76.47405</td>
<td align="right">15.31241</td>
<td align="right">0.0197040</td>
<td align="right">0.0197040</td>
<td align="left">path</td>
<td align="left">30643853</td>
<td align="right">1</td>
<td align="right">0.0354672</td>
<td align="right">0.0354672</td>
</tr>
<tr class="even">
<td>48</td>
<td align="right">2</td>
<td align="right">48</td>
<td align="left">338907543</td>
<td align="right">76.47405</td>
<td align="right">15.31241</td>
<td align="left">338905220</td>
<td align="right">76.47398</td>
<td align="right">15.31224</td>
<td align="right">0.0197040</td>
<td align="right">0.0197040</td>
<td align="left">path</td>
<td align="left">30643853</td>
<td align="right">1</td>
<td align="right">0.0354672</td>
<td align="right">0.0354672</td>
</tr>
<tr class="odd">
<td>49</td>
<td align="right">2</td>
<td align="right">49</td>
<td align="left">338907543</td>
<td align="right">76.47405</td>
<td align="right">15.31241</td>
<td align="left">2398957585</td>
<td align="right">76.47410</td>
<td align="right">15.31259</td>
<td align="right">0.0213917</td>
<td align="right">0.0213917</td>
<td align="left">path</td>
<td align="left">30643853</td>
<td align="right">1</td>
<td align="right">0.0385051</td>
<td align="right">0.0385051</td>
</tr>
<tr class="even">
<td>50</td>
<td align="right">2</td>
<td align="right">50</td>
<td align="left">2398957585</td>
<td align="right">76.47410</td>
<td align="right">15.31259</td>
<td align="left">338907543</td>
<td align="right">76.47405</td>
<td align="right">15.31241</td>
<td align="right">0.0213917</td>
<td align="right">0.0213917</td>
<td align="left">path</td>
<td align="left">30643853</td>
<td align="right">1</td>
<td align="right">0.0385051</td>
<td align="right">0.0385051</td>
</tr>
<tr class="odd">
<td>51</td>
<td align="right">2</td>
<td align="right">51</td>
<td align="left">2398957585</td>
<td align="right">76.47410</td>
<td align="right">15.31259</td>
<td align="left">338907597</td>
<td align="right">76.47413</td>
<td align="right">15.31279</td>
<td align="right">0.0221521</td>
<td align="right">0.0221521</td>
<td align="left">path</td>
<td align="left">30643853</td>
<td align="right">1</td>
<td align="right">0.0398737</td>
<td align="right">0.0398737</td>
</tr>
<tr class="even">
<td>52</td>
<td align="right">2</td>
<td align="right">52</td>
<td align="left">338907597</td>
<td align="right">76.47413</td>
<td align="right">15.31279</td>
<td align="left">2398957585</td>
<td align="right">76.47410</td>
<td align="right">15.31259</td>
<td align="right">0.0221521</td>
<td align="right">0.0221521</td>
<td align="left">path</td>
<td align="left">30643853</td>
<td align="right">1</td>
<td align="right">0.0398737</td>
<td align="right">0.0398737</td>
</tr>
</tbody>
</table>
<p>A <code>"path"</code> offers ideal walking conditions, and so weighted distances are equal to actual distances.</p>
</div>
<div id="usage-distances" class="section level2">
<h2 class="hasAnchor">
<a href="#usage-distances" class="anchor"></a>Usage: Distances</h2>
<p>The many-to-many nature of <code>dodgr</code> means that the function to calculate distances, <a href="https://atfutures.github.io/dodgr/reference/dodgr_distances.html"><code><a href="reference/dodgr_distances.html">dodgr_distances()</a></code></a>, accepts two vectors or matrices of routing points as inputs (describing origins and destinations), and returns a corresponding matrix of pairwise distances. If an input graph has columns for both distances and weighted distances, the latter are used to determine the effectively shortest routes through a network, while actual distances returned are sums of actual distances along those routes.</p>
<p>Routing points can, for example, be randomly selected from the vertices of a graph. The vertices can in turn be extracted with the <code><a href="reference/dodgr_vertices.html">dodgr_vertices()</a></code> function:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">v &lt;-<span class="st"> </span><span class="kw"><a href="reference/dodgr_vertices.html">dodgr_vertices</a></span> (graph)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span> (v)</a></code></pre></div>
<table class="table table">
<thead><tr class="header">
<th></th>
<th align="left">id</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="right">component</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td align="left">339318500</td>
<td align="right">76.47489</td>
<td align="right">15.34169</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>2</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>4</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>6</td>
<td align="left">1427116077</td>
<td align="right">76.47628</td>
<td align="right">15.34179</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td>8</td>
<td align="left">339318503</td>
<td align="right">76.47641</td>
<td align="right">15.34190</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>10</td>
<td align="left">2398958034</td>
<td align="right">76.47650</td>
<td align="right">15.34199</td>
<td align="right">1</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<p>For OSM data extracted with the <code>osmdata</code> package (or, equivalently, via the <code><a href="reference/dodgr_streetnet.html">dodgr::dodgr_streetnet()</a></code> function), each object (vertices, ways, and high-level relations between these objects) is assigned a unique identifying number. These are retained both in <code>osmdata</code> and <code>dodgr</code>, as the <code>way_id</code> column in the above <code>graph</code>, and as the <code>id</code> column in the vertices. Random vertices may be generated in this case through selecting <code>id</code> values:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">from &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span> (v<span class="op">$</span>id, <span class="dt">size =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">to &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span> (v<span class="op">$</span>id, <span class="dt">size =</span> <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">d &lt;-<span class="st"> </span><span class="kw"><a href="reference/dodgr_dists.html">dodgr_dists</a></span> (<span class="dt">graph =</span> graph, <span class="dt">from =</span> from, <span class="dt">to =</span> to)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span> (d)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; [1] 20 50</span></a></code></pre></div>
<p>Alternatively, the points may be specified as matrices of geographic coordinates:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">from_x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span> (graph<span class="op">$</span>from_lon) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span> (<span class="dv">20</span>) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/diff">diff</a></span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span> (graph<span class="op">$</span>from_lon))</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">from_y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span> (graph<span class="op">$</span>from_lat) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span> (<span class="dv">20</span>) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/diff">diff</a></span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span> (graph<span class="op">$</span>from_lat))</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">to_x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span> (graph<span class="op">$</span>from_lon) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span> (<span class="dv">50</span>) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/diff">diff</a></span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span> (graph<span class="op">$</span>from_lon))</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">to_y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span> (graph<span class="op">$</span>from_lat) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span> (<span class="dv">50</span>) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/diff">diff</a></span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span> (graph<span class="op">$</span>from_lat))</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">d &lt;-<span class="st"> </span><span class="kw"><a href="reference/dodgr_dists.html">dodgr_dists</a></span> (<span class="dt">graph =</span> graph, <span class="dt">from =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span> (from_x, from_y), <span class="dt">to =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span> (to_x, to_y))</a></code></pre></div>
<p>In this case, the random points will be mapped on to the nearest points on the street network. This may, of course, map some points onto minor, disconnected components of the graph. This can be controlled either by reducing the graph to it’s largest connected component only:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">graph &lt;-<span class="st"> </span>graph [graph<span class="op">$</span>component <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, ]</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span> (graph)</a></code></pre></div>
<p>or by explicitly using the <code><a href="reference/match_points_to_graph.html">match_points_to_graph()</a></code> function with the option <code>connected = TRUE</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">from &lt;-<span class="st"> </span><span class="kw"><a href="reference/match_points_to_graph.html">match_points_to_graph</a></span> (v, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span> (from_x, from_y), <span class="dt">connected =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">to &lt;-<span class="st"> </span><span class="kw"><a href="reference/match_points_to_graph.html">match_points_to_graph</a></span> (v, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span> (to_x, to_y), <span class="dt">connected =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>This function returns an index into the result of <code>dodgr_vertices</code>, and so points to use for routing must then be extracted as follows:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">from &lt;-<span class="st"> </span>v<span class="op">$</span>id [from] <span class="co"># or from &lt;- v [from, c ("x", "y")]</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">to &lt;-<span class="st"> </span>v<span class="op">$</span>id [to]</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">d &lt;-<span class="st"> </span><span class="kw"><a href="reference/dodgr_dists.html">dodgr_dists</a></span> (<span class="dt">graph =</span> graph, <span class="dt">from =</span> from, <span class="dt">to =</span> to)</a></code></pre></div>
</div>
<div id="usage-flow-aggregation" class="section level2">
<h2 class="hasAnchor">
<a href="#usage-flow-aggregation" class="anchor"></a>Usage: Flow Aggregation</h2>
<p>Flow aggregation refers to the procedure of routing along multiple ways according to specified densities of flow between defined origin and destination points, and aggregating flows along each edge of the network. The procedure is functionally similar to the above procedure for distances, with the addition of a matrix specifying pairwise flow densities between the input set of origin (<code>from</code>) and destination (<code>to</code>) points. The following example illustrates use with a random “flow matrix”:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">flows &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/array">array</a></span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span> (from) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span> (to)), <span class="dt">dim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span> (from), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span> (to)))</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span> (from); <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span> (to); <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span> (flows)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt; [1] 20</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt; [1] 50</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; [1] 20 50</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">f &lt;-<span class="st"> </span><span class="kw"><a href="reference/dodgr_flows_aggregate.html">dodgr_flows_aggregate</a></span> (<span class="dt">graph =</span> graph, <span class="dt">from =</span> from, <span class="dt">to =</span> to, <span class="dt">flows =</span> flows)</a></code></pre></div>
<p>The result is simply the input <code>graph</code> with an additional column quantifying the aggregate flows along each edge:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span> (f)</a></code></pre></div>
<table class="table table">
<thead><tr class="header">
<th align="right">geom_num</th>
<th align="right">edge_id</th>
<th align="left">from_id</th>
<th align="right">from_lon</th>
<th align="right">from_lat</th>
<th align="left">to_id</th>
<th align="right">to_lon</th>
<th align="right">to_lat</th>
<th align="right">d</th>
<th align="right">d_weighted</th>
<th align="left">highway</th>
<th align="left">way_id</th>
<th align="right">component</th>
<th align="right">time</th>
<th align="right">time_weighted</th>
<th align="right">flow</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="left">339318500</td>
<td align="right">76.47489</td>
<td align="right">15.34169</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="right">0.1324422</td>
<td align="right">0.1471580</td>
<td align="left">service</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">0.0953584</td>
<td align="right">0.1059537</td>
<td align="right">7.496538</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="left">339318500</td>
<td align="right">76.47489</td>
<td align="right">15.34169</td>
<td align="right">0.1324422</td>
<td align="right">0.1471580</td>
<td align="left">service</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">0.0953584</td>
<td align="right">0.1059537</td>
<td align="right">11.278624</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="right">0.0088887</td>
<td align="right">0.0098763</td>
<td align="left">service</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">0.0063998</td>
<td align="right">0.0071109</td>
<td align="right">7.496538</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="left">339318502</td>
<td align="right">76.47612</td>
<td align="right">15.34173</td>
<td align="right">0.0088887</td>
<td align="right">0.0098763</td>
<td align="left">service</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">0.0063998</td>
<td align="right">0.0071109</td>
<td align="right">11.278624</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="left">1427116077</td>
<td align="right">76.47628</td>
<td align="right">15.34179</td>
<td align="right">0.0093265</td>
<td align="right">0.0103628</td>
<td align="left">service</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">0.0067151</td>
<td align="right">0.0074612</td>
<td align="right">7.496538</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">6</td>
<td align="left">1427116077</td>
<td align="right">76.47628</td>
<td align="right">15.34179</td>
<td align="left">2398958028</td>
<td align="right">76.47621</td>
<td align="right">15.34174</td>
<td align="right">0.0093265</td>
<td align="right">0.0103628</td>
<td align="left">service</td>
<td align="left">28565950</td>
<td align="right">1</td>
<td align="right">0.0067151</td>
<td align="right">0.0074612</td>
<td align="right">11.278624</td>
</tr>
</tbody>
</table>
<p>An additional flow aggregation function can be applied in cases where only densities at origin points are known, and movement throughout a graph is dispersive:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">f &lt;-<span class="st"> </span><span class="kw"><a href="reference/dodgr_flows_disperse.html">dodgr_flows_disperse</a></span> (<span class="dt">graph =</span> graph, <span class="dt">from =</span> from, <span class="dt">dens =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span> (from)))</a></code></pre></div>
</div>
<div id="further-detail" class="section level2">
<h2 class="hasAnchor">
<a href="#further-detail" class="anchor"></a>Further detail</h2>
<p>For more detail, see the <a href="https://atfutures.github.io/dodgr/articles/dodgr.html">main package vignette</a>, along with a second vignette detailing <a href="https://atfutures.github.io/dodgr/articles/benchmark.html">benchmark timings</a>, showing that under many circumstances, <code>dodgr</code> performs considerably faster than equivalent routines from the <code>igraph</code> package.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=dodgr">https://​cloud.r-project.org/​package=dodgr</a>
</li>
<li>Browse source code at <br><a href="https://github.com/ATFutures/dodgr">https://​github.com/​ATFutures/​dodgr</a>
</li>
<li>Report a bug at <br><a href="https://github.com/ATFutures/dodgr/issues">https://​github.com/​ATFutures/​dodgr/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing dodgr</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Mark Padgham <br><small class="roles"> Author, maintainer </small>  </li>
<li>Andreas Petutschnig <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/ATFutures/dodgr"><img src="https://travis-ci.org/ATFutures/dodgr.svg" alt="Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/ATFutures/dodgr"><img src="https://ci.appveyor.com/api/projects/status/github/ATFutures/dodgr?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a></li>
<li><a href="https://codecov.io/gh/ATFutures/dodgr"><img src="https://codecov.io/gh/ATFutures/dodgr/branch/master/graph/badge.svg" alt="codecov"></a></li>
<li><a href="http://www.repostatus.org/#active"><img src="http://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active"></a></li>
<li><a href="https://cran.r-project.org/package=dodgr"><img src="http://www.r-pkg.org/badges/version/dodgr" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://cran.r-project.org/package=dodgr"><img src="http://cranlogs.r-pkg.org/badges/grand-total/dodgr?color=orange" alt="CRAN Downloads"></a></li>
<li><a href="https://bestpractices.coreinfrastructure.org/projects/1396"><img src="https://bestpractices.coreinfrastructure.org/projects/1396/badge" alt="CII Best Practices"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Mark Padgham, Andreas Petutschnig.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
